2025-01-11 01:18:36,300 - INFO - Initializing DataProcessor for fine-tuning...
2025-01-11 01:18:37,037 - INFO - Data loaded and processed successfully.
2025-01-11 01:18:37,037 - INFO - Loading label encoder from /data/A-TrajectoryTransformer/models/transformer/mobis/label_encoder.joblib...
2025-01-11 01:18:37,041 - INFO - Label encoder loaded and assigned to DataProcessor.
2025-01-11 01:18:37,041 - INFO - Clearing old sequences and re-creating them using loaded encoder...
2025-01-11 01:18:37,535 - INFO - Sequences re-created successfully.
2025-01-11 01:18:37,536 - INFO - DataLoaders for train, val, and test are ready.
2025-01-11 01:18:37,537 - INFO - Initializing model for fine-tuning...
2025-01-11 01:18:41,082 - INFO - Loading pretrained model from: /data/A-TrajectoryTransformer/models/transformer/mobis/best_model.pth
2025-01-11 01:18:41,096 - INFO - Pretrained model loaded successfully.
2025-01-11 01:18:41,096 - INFO - Unfrozen all layers of the transformer encoder.
2025-01-11 01:18:41,098 - INFO - Optimizer re-initialized to only update unfrozen parameters.
2025-01-11 01:18:41,098 - INFO - Starting the fine-tuning process...
2025-01-11 01:18:41,754 - INFO - [Epoch 1/10] Train Loss: 4.8988, Train Acc: 0.3816, Val Loss: 2.7968, Val Acc: 0.4861
2025-01-11 01:18:41,812 - INFO -   -> Best fine-tuned model saved.
2025-01-11 01:18:42,109 - INFO - [Epoch 2/10] Train Loss: 2.5019, Train Acc: 0.5000, Val Loss: 1.5268, Val Acc: 0.5799
2025-01-11 01:18:42,148 - INFO -   -> Best fine-tuned model saved.
2025-01-11 01:18:42,445 - INFO - [Epoch 3/10] Train Loss: 1.2830, Train Acc: 0.5132, Val Loss: 0.9013, Val Acc: 0.6910
2025-01-11 01:18:42,473 - INFO -   -> Best fine-tuned model saved.
2025-01-11 01:18:42,770 - INFO - [Epoch 4/10] Train Loss: 0.6686, Train Acc: 0.7237, Val Loss: 0.8174, Val Acc: 0.7014
2025-01-11 01:18:42,811 - INFO -   -> Best fine-tuned model saved.
2025-01-11 01:18:43,111 - INFO - [Epoch 5/10] Train Loss: 0.5548, Train Acc: 0.7763, Val Loss: 0.6618, Val Acc: 0.7743
2025-01-11 01:18:43,167 - INFO -   -> Best fine-tuned model saved.
2025-01-11 01:18:43,441 - INFO - [Epoch 6/10] Train Loss: 0.4716, Train Acc: 0.8158, Val Loss: 0.6124, Val Acc: 0.7882
2025-01-11 01:18:43,543 - INFO -   -> Best fine-tuned model saved.
2025-01-11 01:18:43,803 - INFO - [Epoch 7/10] Train Loss: 0.4279, Train Acc: 0.8158, Val Loss: 0.6807, Val Acc: 0.7361
2025-01-11 01:18:43,804 - INFO -   -> No improvement (1/5)
2025-01-11 01:18:44,074 - INFO - [Epoch 8/10] Train Loss: 0.3841, Train Acc: 0.8289, Val Loss: 0.8613, Val Acc: 0.6944
2025-01-11 01:18:44,074 - INFO -   -> No improvement (2/5)
2025-01-11 01:18:44,363 - INFO - [Epoch 9/10] Train Loss: 0.3563, Train Acc: 0.8421, Val Loss: 0.9608, Val Acc: 0.6771
2025-01-11 01:18:44,364 - INFO -   -> No improvement (3/5)
2025-01-11 01:18:44,615 - INFO - [Epoch 10/10] Train Loss: 0.3123, Train Acc: 0.8947, Val Loss: 1.0797, Val Acc: 0.6840
2025-01-11 01:18:44,616 - INFO -   -> No improvement (4/5)
2025-01-11 01:18:44,617 - INFO - 
Loading best fine-tuned model from finetuned_model.pth for final evaluation...
2025-01-11 01:18:44,876 - INFO - Test Loss: 0.5845, Test Accuracy: 0.8233
2025-01-11 01:18:45,115 - INFO - Classification Report:
              precision    recall  f1-score   support

        bike       0.18      0.10      0.13        91
         bus       0.80      0.69      0.74       335
         car       0.90      0.94      0.92       510
       train       0.86      0.20      0.32        30
        walk       0.82      1.00      0.90       409

    accuracy                           0.82      1375
   macro avg       0.71      0.58      0.60      1375
weighted avg       0.80      0.82      0.80      1375

2025-01-11 01:18:45,334 - INFO - Confusion matrix saved as 'confusion_matrix_finetune.png'.
2025-01-11 01:18:45,334 - INFO - Fine-tuning script completed successfully.
